<html>
<head><title>Gulp</title></head>
<body>
<h1>Gulp</h1><p><br />
Compiling Gulp code on taras cluster
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Requirements"><span class="tocnumber">1</span> <span class="toctext">Requirements</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#GCC_10.2.0"><span class="tocnumber">2</span> <span class="toctext">GCC 10.2.0</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#BLAS"><span class="tocnumber">3</span> <span class="toctext">BLAS</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#LAPACK"><span class="tocnumber">4</span> <span class="toctext">LAPACK</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#OPENMPI"><span class="tocnumber">5</span> <span class="toctext">OPENMPI</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#SCALAPACK"><span class="tocnumber">6</span> <span class="toctext">SCALAPACK</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#GULP"><span class="tocnumber">7</span> <span class="toctext">GULP</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Slurm_submission_script"><span class="tocnumber">8</span> <span class="toctext">Slurm submission script</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Requirements">Requirements</span></h1>
<h1><span class="mw-headline" id="GCC_10.2.0">GCC 10.2.0</span></h1>
<pre>
download source from gcc site
wget ftp://ftp.lip6.fr/pub/gcc/releases/gcc-10.2.0/gcc-10.2.0.tar.xz
cd /scratch/tmssoft
tar -Jxf gcc-10.2.0.tar.xz
cd gcc-10.2.0
./configure --with-system-zlib --disable-multilib --enable-languages=c,c++,fortran --prefix=/auto/soft/compiler/gnu-10.2.0
make -j 10
make install
</pre>
<h1><span class="mw-headline" id="BLAS">BLAS</span></h1>
<pre>module load compiler/gnu-10.2.0
</pre>
<pre>
wget http://www.netlib.org/blas/blas-3.8.0.tgz
tar xzvf blas-3.8.0.tgz
cd BLAS-3.8.0
cat make.inc
make 
make clean
ln -s blas_LINUX.a libblas.a
mkdir /auto/soft/blas/3.8.0-gnu-10.2.0
cp libblas.a /auto/soft/blas/3.8.0-gnu-10.2.0/
</pre>
<h1><span class="mw-headline" id="LAPACK">LAPACK</span></h1>
<pre>module load compiler/gnu-10.2.0
</pre>
<pre>
wget https://github.com/Reference-LAPACK/lapack/archive/v3.9.0.tar.gz
tar -zxvf v-3.9.0.tgz 
cd lapack-3.9.0/
cp INSTALL/make.inc.gfortran make.inc
make lapacklib
make clean
mkdir /auto/soft/lapack/3.9.0-gnu-10.2.0
cp liblapack.a /auto/soft/lapack/3.9.0-gnu-10.2.0/

</pre>
<h1><span class="mw-headline" id="OPENMPI">OPENMPI</span></h1>
<pre>module load compiler/gnu-10.2.0
</pre>
<pre>
wget https://download.open-mpi.org/release/open-mpi/v4.1/openmpi-4.1.0.tar.bz2
tar -jxf openmpi-4.1.0.tar.bz2 
cd openmpi-4.1.0
./configure --prefix=/auto/soft/openmpi/4.1.0-gnu-10.2.0
make -j 30
make install

</pre>
<h1><span class="mw-headline" id="SCALAPACK">SCALAPACK</span></h1>
<pre>module load compiler/gnu-10.2.0
</pre>
<pre>
wget http://www.netlib.org/scalapack/scalapack-2.1.0.tgz
tar xvf scalapack-2.0.2.tgz
cd scalapack-2.1.0
cp SLmake.inc.example SLmake.inc
vim SLmake.inc
  BLASLIB       = -lblas -L/auto/soft/blas/3.8.0-gnu-10.2.0/
  LAPACKLIB     = -llapack -L/auto/soft/lapack/3.9.0-gnu-10.2.0/
  LIBS          = $(LAPACKLIB) $(BLASLIB)
make -j 10
mkdir /auto/soft/scalapack/2.1.0-openmpi-4.1.0-gnu-10.2.0
cp libscalapack.a /auto/soft/scalapack/2.1.0-openmpi-4.1.0-gnu-10.2.0

</pre>
<h1><span class="mw-headline" id="GULP">GULP</span></h1>
<pre>
tar -zxf source
</pre>
<pre>
$ cat /auto/soft/gulp/5.2/Src/mkgulp 
#! /bin/sh
#
# This shell script adapts the Makefile in dependence
# of the machine and the operating system you use.
# It is called from 'make' before the compiler
# is invoked.
#
# NB: Some values may need to be changed for your specific machine.
#     To find the bits where user modification may be required 
#     search for the tag "USER". Lines between "USER--Start" and
#     "USER--End" may be commented or uncommented (or changed if
#     necessary) to suit your machine. Other parts of this file 
#     should not need to be modified.
#
# On Raijin at NCI, there are modifications to be made where NCI is
# mentioned. The GULP module on this system was built with:
#
# - Intel compilers and MKL version 17.0.1.132
# - fftw3-mkl/17.0.1.132
# - openmpi/2.1.1
# - plumed/2.3.5
#
#  1/18 Major modification to simplify
#  2/18 Handling of Lapack and Blas modified
#  2/18 Support for parallel make added
#  8/19 Cray compiler added
#
#  Initial version written by J-R. Hill
#  Re-written by JDG
#
#  Initialise arguments
#
compiler="gfortran -std=legacy -fallow-argument-mismatch"
debug=
fftw3=
kim=
parallel=
plumed=
task="gulp"
pmake=
#
#  Parse arguments to mkgulp
#
while getopts dmpkfhelpc:t:j: option; do
  case "$option" in
    d)
       debug="_Debug"
      &#160;;;
    m)
       parallel="_MPI"
      &#160;;;
    p)
       plumed="_Plumed"
      &#160;;;
    f)
       fftw3="_FFTW3"
      &#160;;;
    k)
       kim="_Kim"
      &#160;;;
    c)
       compiler=$OPTARG
      &#160;;;
    t)
       task=$OPTARG
      &#160;;;
    j)
       pmake=$OPTARG
      &#160;;;
    h)
       echo ' '
       echo ' Make GULP available options&#160;:'
       echo ' '
       echo ' -c ARG =&gt; specifies compiler to be used '
       echo '           ARG = gfortran (default)'
       echo '               = intel'
       echo '               = cray'
       echo ' -d =&gt; make debug version '
       echo ' -f =&gt; compile and link to FFTW3 '
       echo ' -j ARG =&gt; specifies the number of processors to be used for make '
       echo ' -k =&gt; compile and link to OpenKIM '
       echo ' -m =&gt; make parallel MPI version '
       echo ' -p =&gt; compile and link to Plumed plug-in '
       echo ' -t ARG =&gt; specifies task to be performed (ARG=gfortran or Intel)'
       echo '           ARG = gulp (default) - build exe'
       echo '               = clean - remove files from compilation of gulp'
       echo '               = fox-clean - remove files from compilation of FoX'
       echo '               = lib - build gulp as a library'
       echo '               = tar - create a tar file'
       echo ' '
       exit
      &#160;;;
    *)
       echo "Invalid option supplied to mkgulp"
       exit
      &#160;;;
  esac
done
#
#  Set up makedir function
#
makedir()
{
  if [&#160;! -d "$dir" ]
  then
    mkdir "$dir"
  fi
  cd $dir
}
#
#  Get operating system name
#
os=`uname -s`
#
#  For FoX clean up we don't need to go into code directory 
#
if [ "$task" = "fox-clean" ] 
then
  cd FoX-4.1.2
  touch arch.make
  make distclean
  exit
elif [ "$task" = "tar" ] 
then
  make tar
  exit
fi
#
#  Make directory for compilation
#
dir="${os}${parallel}${fftw3}${kim}${plumed}${debug}"
makedir
#
#  Initialise makefile
#
echo '# GULP makefile&#160;: ' &gt; makefile
#
#  UDEFS:
#
#  -DNOFOX   =&gt; do not compile FoX related subroutines
#  -DCTRLC   =&gt; compile with calls to csignal to trap Control C escape sequence
#  -DOLDCS   =&gt; compile for old version of ChemShell (pre-2017)
#
#  Set options for UDEFS (user definitions) here
#
#--USER--Start
echo 'UDEFS=-DFLUSH -DNOFOX ' &gt;&gt; makefile
#--USER--End

#
#  Open KIM - to set -DKIM in UDEFS
#
if [ "$kim" = "" ]
then
  echo 'KDEFS=' &gt;&gt; makefile
  echo "KFLAGS=" &gt;&gt; makefile
  echo 'KLIBS=' &gt;&gt; makefile
else
#
# For current version of OpenKIM use the following
#
#--USER--Start
  echo 'KDEFS=-DKIM' &gt;&gt; makefile
  echo "KFLAGS=-I/usr/local/lib/kim-api/mod/" &gt;&gt; makefile
  echo "KLIBS=-L/usr/local/lib/ -lkim-api " &gt;&gt; makefile
#--USER--End
fi

#
#  Include file directories
#
#--USER--Start
echo 'INC=-I.. -I/usr/local/include/ ' &gt;&gt; makefile
#--USER--End
#  If using Macports then use the following instead
#--USER--Start
#echo 'INC=-I.. -I/opt/local/include/ -I/usr/local/include/' &gt;&gt; makefile
#--USER--End

#
#  Compiler specific options
#
case $compiler in
  gfortran)
           if [ "$debug" = "" ]
           then
               echo 'OPT=-O3 -ffpe-summary=invalid,zero,overflow ' &gt;&gt; makefile
               echo 'OPT2=-O2 -ffpe-summary=invalid,zero,overflow ' &gt;&gt; makefile
               echo 'OPT1=-O1 -ffpe-summary=invalid,zero,overflow ' &gt;&gt; makefile
           else
               echo 'OPT=' &gt;&gt; makefile
               echo 'OPT1=' &gt;&gt; makefile
               echo 'OPT2=-ffloat-store' &gt;&gt; makefile
               echo 'BAGGER=-g -Wall -Wunused-parameter -fbounds-check -Wuninitialized -fbacktrace' &gt;&gt; makefile
           fi
           if [ "$parallel" = "" ]
           then
#               echo 'RUNF90=gfortran-mp-8 ' &gt;&gt; makefile
               echo 'RUNF90=gfortran ' &gt;&gt; makefile
#  gfortran with accelerate framework
#               echo 'RUNF90=gfortran -framework accelerate ' &gt;&gt; makefile
#               echo 'RUNCC=gcc-mp-8 ' &gt;&gt; makefile
               echo 'RUNCC=gfortran ' &gt;&gt; makefile
               echo 'SLIBS= ' &gt;&gt; makefile
#  If there are optimised maths libraries available replace the routines below
#--USER--Start
#               echo 'MLIBS=lapack.o blas.o' &gt;&gt; makefile
               echo 'MLIBS=-L/auto/soft/blas/3.8.0-gnu-10.2.0/ -L/auto/soft/lapack/3.9.0-gnu-10.2.0/ -llapack -lblas ' &gt;&gt; makefile
#--USER--End
           else
               echo 'RUNF90=mpif90 -fallow-argument-mismatch -std=legacy' &gt;&gt; makefile
               echo 'RUNCC=mpif90 -fallow-argument-mismatch -std=legacy  ' &gt;&gt; makefile
#  Provide the location and name of Scalapack, Blacs, Pblas, Lapack and Blas libraries.
#  On the Mac the following is sufficient when using Macports:
#--USER--Start
               echo 'SLIBS=-L/auto/soft/scalapack/2.1.0-openmpi-4.1.0-gnu-10.2.0/ -L/opt/local/lib -lscalapack ' &gt;&gt; makefile
               echo 'MLIBS=-L/auto/soft/blas/3.8.0-gnu-10.2.0/ -L/auto/soft/lapack/3.9.0-gnu-10.2.0/ -llapack -lblas ' &gt;&gt; makefile
#--USER--End
           fi
          &#160;;;
  intel)
           if [ "$debug" = "" ]
           then
               echo 'OPT=-O3 ' &gt;&gt; makefile
               echo 'OPT2=-O2' &gt;&gt; makefile
               echo 'OPT1=-O1' &gt;&gt; makefile
           else
               echo 'OPT=' &gt;&gt; makefile
               echo 'OPT1=' &gt;&gt; makefile
               echo 'OPT2=-ffloat-store' &gt;&gt; makefile
               echo 'BAGGER=-g -traceback -O0 -debug all -ftrapuv' &gt;&gt; makefile
           fi
           if [ "$parallel" = "" ]
           then
               echo 'RUNF90=ifort ' &gt;&gt; makefile
               echo 'RUNCC=icc ' &gt;&gt; makefile
               echo 'SLIBS= ' &gt;&gt; makefile
#  If there are optimised maths libraries available replace the routines below
#--USER--Start
               echo 'MLIBS=lapack.o blas.o' &gt;&gt; makefile
#--USER--End
           else
               echo 'RUNF90=mpif90 ' &gt;&gt; makefile
               echo 'RUNCC=mpicc ' &gt;&gt; makefile
#  Use maths libraries from MKL with the Intel compiler:
#--USER--Start
#  The following link line has been test for Intel 2018.1.163 on NCI.
               echo 'SLIBS=-L${MKLROOT}/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -lmkl_blacs_intelmpi_lp64 -lpthread -lm -ldl ' &gt;&gt; makefile
#  The following is used on NCI for the gulp module:
#                echo 'SLIBS= -L${MKLROOT}/lib/intel64/libmkl_blas95_lp64.a ${MKLROOT}/lib/intel64/libmkl_lapack95_lp64.a -L${MKLROOT}/lib/intel64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lmkl_blacs_openmpi_lp64 -liomp5 -lpthread -lm -ldl ' &gt;&gt; makefile
               echo 'MLIBS= ' &gt;&gt; makefile
#--USER--End
           fi
          &#160;;;
  cray)
           if [ "$debug" = "" ]
           then
               echo 'OPT=-O3 ' &gt;&gt; makefile
               echo 'OPT2=-O2' &gt;&gt; makefile
               echo 'OPT1=-O1' &gt;&gt; makefile
           else
               echo 'OPT=' &gt;&gt; makefile
               echo 'OPT1=' &gt;&gt; makefile
               echo 'OPT2=' &gt;&gt; makefile
               echo 'BAGGER=-g -O0 -h bounds -Ktrap=divz' &gt;&gt; makefile
           fi
#
#  No different below for Cray since the norm is to use parallel and maths libraries are provided
#
           if [ "$parallel" = "" ]
           then
               echo 'RUNF90=ftn ' &gt;&gt; makefile
               echo 'RUNCC=cc ' &gt;&gt; makefile
               echo 'SLIBS= ' &gt;&gt; makefile
           else
               echo 'RUNF90=ftn ' &gt;&gt; makefile
               echo 'RUNCC=cc ' &gt;&gt; makefile
               echo 'SLIBS= ' &gt;&gt; makefile
           fi
          &#160;;;
#
# This is an unknown compiler
#
  *)       echo "Sorry, the compiler '$compiler' is not configured."
           echo "Edit 'mkgulp' to include the required options."
           exit 1
          &#160;;;
esac

#
#  Parallel compilation options
#
if [ "$parallel" = "" ]
then
  echo 'MDEFS= ' &gt;&gt; makefile
else
  echo 'MDEFS=-DMPI ' &gt;&gt; makefile
fi

#
#  Plumed compilation options
#
if [ "$plumed" = "" ]
then
  echo 'PDEFS=' &gt;&gt; makefile
  echo 'PLIBS=' &gt;&gt; makefile
  echo 'PLUMEDDEFS= ' &gt;&gt; makefile
else
  echo 'PDEFS=-DPLUMED ' &gt;&gt; makefile
  echo 'PLIBS=-lplumed ' &gt;&gt; makefile
  echo 'PLUMEDDEFS=-DDL_POLY' &gt;&gt; makefile
fi

#
#  FFTW3 compilation options
#
if [ "$fftw3" = "" ]
then
  echo 'FDEFS=' &gt;&gt; makefile
  echo 'FLIBS=' &gt;&gt; makefile
else
  echo 'FDEFS=-DFFTW3 ' &gt;&gt; makefile
  if [ "$parallel" = "" ]
#--USER--Start
    echo 'FLIBS=-L/usr/local/lib/ -lfftw3.a' &gt;&gt; makefile
#--USER--End
  then
#--USER--Start
    echo 'FLIBS=-L/usr/local/lib/ -lfftw3 -lfftw3_mpi' &gt;&gt; makefile
#  The following is for NCI
#    echo 'FLIBS=-mkl -lfftw3x_cdft_openmpi_lp64'
#--USER--End
  fi
fi

#
#  Set general commands that should rarely need to be modified
#
echo 'ARCHIVE = ar rcv' &gt;&gt; makefile
echo 'RANLIB = ar ts' &gt;&gt; makefile
echo 'GULPENV=' &gt;&gt; makefile
echo 'CDABS=cdabs.o' &gt;&gt; makefile
echo 'LDFLAGS=' &gt;&gt; makefile
echo 'FOPT=' &gt;&gt; makefile
echo 'COPT=' &gt;&gt; makefile

cat ../Makefile &gt;&gt; makefile
#
#  Perform make 
#
if [ "$pmake" = "" ]
then
  make $task
else
#
#  Check whether argument to -j is an integer
#
  if [[ $pmake&#160;!= [0-9]* ]]; then
    echo 'Error: argument to -j option is not an integer'
    exit
  else
    make -j $pmake $task
  fi
fi
#
#  Clean up by remove temporary makefile
#
rm -f makefile

if [ "$task" = "lib" ]
then
#
#  Move library to top of GULP tree
#
mv libgulp.a ../../libgulp.a
elif [ "$task" = "gulp" ]
then
#
# Move executable back to level at which make command was issued
#
mv gulp ../gulp
fi
</pre>
<pre>
 ./mkgulp -c gfortran -m
</pre>
<h1><span class="mw-headline" id="Slurm_submission_script">Slurm submission script</span></h1>
<pre>
--------------------------------------------------------------------------------------------------------
$ cat submit.sh

#!/bin/bash

#SBATCH -p taras
#SBATCH -N 1
#SBATCH -n 4
#SBATCH --time=00:02:00
#SBATCH --job-name=gulp-test
#SBATCH --output=output.%j.gulp-test
#SBATCH --error=error.%j.gulp-test

set -x 

module purge
module load gulp/5.2_4.1.0-openmpi-gnu-10.2.0

mpirun -np ${SLURM_NTASKS} --mca pml ob1 --mca btl tcp,self --mca mtl_base_verbose 100  gulp  example1
</pre>
<p>Input / output of exampe1.gin
</p>
<pre>
$ cat example1.gin 

opti prop conp 
title
alumina test file
end
cell
4.7602   4.7602  12.9933  90.000000  90.000000 120.0
frac
Al core 0.000000   0.000000   0.352160 
Al shel 0.000000   0.000000   0.352160 
O  core 0.306240   0.000000   0.250000 
O  shel 0.306240   0.000000   0.250000 
space
167
species
Al core  0.043
Al shel  2.957
O  core  0.513
O  shel -2.513
buckingham
Al shel O shel  2409.505 0.2649  0.00 0.0 10.0
O  shel O shel    25.410 0.6937 32.32 0.0 12.0
spring
Al 403.98
O   20.53
output xr example1
output marvin example1.mvn


---------------------------------------------------------------------------------------------------------
$ cat example1.gout

********************************************************************************
*                       GENERAL UTILITY LATTICE PROGRAM                        *
*                                 Julian Gale                                  *
*                       Curtin Institute for Computation                       *
*                    School of Molecular and Life Sciences                     *
*                    Curtin University, Western Australia                      *
********************************************************************************
* Version = 5.2.0 * Last modified =  10th September 2020                       *
********************************************************************************
*  optimise     - perform optimisation run                                     *
*  conp         - constant pressure calculation                                *
*  property     - calculate properties for final geometry                      *
********************************************************************************
* alumina test file                                                            *
********************************************************************************


  Job Started  at 12:50.28  4th February   2021                               

  Number of CPUs =     4

  Host name      = cns06                                   


  Total number of configurations input =      1

********************************************************************************
*  Input for Configuration =   1                                               *
********************************************************************************

  Formula = Al4O6                                                       

  Number of irreducible atoms/shells =       4


  Total number atoms/shells =      20

  Dimensionality = 3              &#160;:  Bulk   


  Symmetry&#160;:

  Crystal family                  &#160;:  Hexagonal   
  Crystal class  (Groth - 1921)   &#160;:  Ditrigonal Scalenohedral             

  Space group (centrosymmetric)   &#160;:  R -3 C          

  Patterson group                 &#160;:  R -3 m   

  Cartesian lattice vectors (Angstroms)&#160;:

        2.380100    1.374151    4.331100
       -2.380100    1.374151    4.331100
        0.000000   -2.748303    4.331100

  Primitive cell parameters&#160;:            Full cell parameters&#160;:

  a =   5.1295    alpha =  55.2915       a =   4.7602    alpha =  90.0000
  b =   5.1295    beta  =  55.2915       b =   4.7602    beta  =  90.0000
  c =   5.1295    gamma =  55.2915       c =  12.9933    gamma = 120.0000

  Initial volumes (Angstroms**3):

  Primitive cell =          84.992234    Full cell =         254.976701

  Temperature of configuration =   0.00     K 

  Pressure of configuration =         0.000 GPa 

  Fractional coordinates of asymmetric unit&#160;:

--------------------------------------------------------------------------------
   No.  Atomic       x           y          z         Charge      Occupancy
        Label      (Frac)      (Frac)     (Frac)        (e)         (Frac)  
--------------------------------------------------------------------------------
      1 Al    c    0.000000    0.000000    0.352160 *   0.04300    1.000000    
      2 O     c    0.306240 *  0.000000    0.250000     0.51300    1.000000    
      3 Al    s    0.000000    0.000000    0.352160 *   2.95700    1.000000    
      4 O     s    0.306240 *  0.000000    0.250000    -2.51300    1.000000    
--------------------------------------------------------------------------------


  Constraints&#160;: 

--------------------------------------------------------------------------------
  Constraint no.      Unconstrained     Constrained    Coefficient    Offset
                         Variable         Variable
--------------------------------------------------------------------------------
           1              Strain 1        Strain 2       1.00000      0.0000
--------------------------------------------------------------------------------


********************************************************************************
*  General input information                                                   *
********************************************************************************

  Species output for all configurations&#160;: 

--------------------------------------------------------------------------------
  Species    Type    Atomic    Atomic    Charge       Radii (Angs)     Library
                     Number     Mass       (e)     Cova   Ionic  VDW   Symbol
--------------------------------------------------------------------------------
    Al       Core       13      26.98   0.043000   1.350  0.000  2.050          
    Al       Shell      13       0.00   2.957000   1.350  0.000  2.050          
    O        Core        8      16.00   0.513000   0.730  0.000  1.360          
    O        Shell       8       0.00  -2.513000   0.730  0.000  1.360          
--------------------------------------------------------------------------------


  Lattice summation method               =    Ewald          (3-D)
                                         =    Parry          (2-D)
                                         =    Saunders et al (1-D)
  Accuracy factor for lattice sums       =   12.000


  Analytic derivatives to be used

  Time limit = Infinity

  Maximum range for interatomic potentials =    100000.000000 Angstroms

  General interatomic potentials&#160;:

--------------------------------------------------------------------------------
Atom  Types   Potential      Parameter       Value         Units   Cutoffs(Ang)
  1     2                                                            Min /  Max 
--------------------------------------------------------------------------------
O    s Al   s Buckingham    Buckingham A     2409.5050    eV        0.000 10.000
                            Buckingham rho  0.26490000    Ang       
                            Buckingham C     0.0000000    eV*Ang^6  
--------------------------------------------------------------------------------
O    s O    s Buckingham    Buckingham A     25.410000    eV        0.000 12.000
                            Buckingham rho  0.69370000    Ang       
                            Buckingham C     32.320000    eV*Ang^6  
--------------------------------------------------------------------------------
Al   c Al   s Spring (c-s)  Spring k 2       403.98000    eV*Ang^-2 0.000  0.800
                            Spring k 4       0.0000000    eV*Ang^-4 
--------------------------------------------------------------------------------
O    c O    s Spring (c-s)  Spring k 2       20.530000    eV*Ang^-2 0.000  0.800
                            Spring k 4       0.0000000    eV*Ang^-4 
--------------------------------------------------------------------------------

********************************************************************************
*  Output for configuration   1                                                *
********************************************************************************


  Components of energy&#160;: 

--------------------------------------------------------------------------------
  Interatomic potentials     =          63.08516927 eV    
  Monopole - monopole (real) =        -126.96762275 eV    
  Monopole - monopole (recip)=        -250.81566546 eV    
  Monopole - monopole (total)=        -377.78328821 eV    
--------------------------------------------------------------------------------
  Total lattice energy&#160;: 
    Primitive unit cell      =        -314.69811894 eV    
    Non-primitive unit cell  =        -944.09435681 eV    
--------------------------------------------------------------------------------
  Total lattice energy (in kJmol-1): 
    Primitive unit cell      =          -30363.5579 kJ/(mole unit cells)
    Non-primitive unit cell  =          -91090.6736 kJ/(mole unit cells)
--------------------------------------------------------------------------------


  Number of variables =        6

  Maximum number of calculations  =          1000
  Maximum Hessian update interval =            10
  Maximum step size               =   1.000000000
  Maximum parameter tolerance     =   0.000010000
  Maximum function  tolerance     =   0.000010000
  Maximum gradient  tolerance     =   0.001000000
  Maximum gradient  component     =   0.010000000

  Symmetry constrained optimisation

  Symmetry used only for first derivatives

  Cell parameters to be optimised using strains

  Newton-Raphson optimiser to be used

  BFGS hessian update to be used

  General 2-D hessian to be used

  Start of bulk optimisation&#160;:

  Cycle:      0 Energy:      -314.698119  Gnorm:     19.420558  CPU:    0.031
  ** Hessian calculated **
  Cycle:      1 Energy:      -315.172727  Gnorm:      0.362449  CPU:    0.037
  Cycle:      2 Energy:      -315.173273  Gnorm:      0.058322  CPU:    0.040
  Cycle:      3 Energy:      -315.173281  Gnorm:      0.002438  CPU:    0.042


  **** Optimisation achieved ****


  Final energy =    -315.17328097 eV
  Final Gnorm  =       0.00009292

  Components of energy&#160;: 

--------------------------------------------------------------------------------
  Interatomic potentials     =          59.49166290 eV    
  Monopole - monopole (real) =         -65.58577192 eV    
  Monopole - monopole (recip)=        -309.07917195 eV    
  Monopole - monopole (total)=        -374.66494387 eV    
--------------------------------------------------------------------------------
  Total lattice energy&#160;: 
    Primitive unit cell      =        -315.17328097 eV    
    Non-primitive unit cell  =        -945.51984290 eV    
--------------------------------------------------------------------------------
  Total lattice energy (in kJmol-1): 
    Primitive unit cell      =          -30409.4037 kJ/(mole unit cells)
    Non-primitive unit cell  =          -91228.2112 kJ/(mole unit cells)
--------------------------------------------------------------------------------

  Final asymmetric unit coordinates&#160;:

--------------------------------------------------------------------------------
   No.  Atomic        x           y           z         Radius
        Label       (Frac)      (Frac)      (Frac)       (Angs) 
--------------------------------------------------------------------------------
     1  Al    c     0.000000    0.000000    0.356233    0.000000
     2  O     c     0.295773    0.000000    0.250000    0.000000
     3  Al    s     0.000000    0.000000    0.356234    0.000000
     4  O     s     0.297426    0.000000    0.250000    0.000000
--------------------------------------------------------------------------------

  Final Cartesian lattice vectors (Angstroms)&#160;:

        2.410027    1.391430    4.337219
       -2.410027    1.391430    4.337219
        0.000000   -2.782860    4.337219


  Final cell parameters and derivatives&#160;:

--------------------------------------------------------------------------------
       a            5.153230 Angstrom     dE/de1(xx)     0.000023 eV/strain
       b            5.153230 Angstrom     dE/de2(yy)     0.000000 eV/strain
       c            5.153230 Angstrom     dE/de3(zz)     0.000029 eV/strain
       alpha       55.766721 Degrees      dE/de4(yz)     0.000000 eV/strain
       beta        55.766721 Degrees      dE/de5(xz)     0.000000 eV/strain
       gamma       55.766721 Degrees      dE/de6(xy)     0.000000 eV/strain
--------------------------------------------------------------------------------

  Primitive cell volume =            87.266162 Angs**3

  Density of cell =      3.880341 g/cm**3

  Non-primitive lattice parameters&#160;:

  a    =     4.820054  b   =     4.820054  c    =    13.011658
  alpha=    90.000000  beta=    90.000000  gamma=   120.000000

  Non-primitive cell volume =           261.798487 Angs**3


  Final internal derivatives&#160;:

--------------------------------------------------------------------------------
   No.  Atomic          a             b             c           Radius
        Label          (eV)          (eV)          (eV)        (eV/Angs)
--------------------------------------------------------------------------------
      1 Al    c       0.000000      0.000000      0.000004      0.000000
      2 O     c      -0.000242      0.000000      0.000000      0.000000
      3 Al    s       0.000000      0.000000     -0.000382      0.000000
      4 O     s       0.000324      0.000000      0.000000      0.000000
--------------------------------------------------------------------------------
  Maximum abs         0.000324      0.000000      0.000382      0.000000
--------------------------------------------------------------------------------


  Born effective charge tensors&#160;: 

-------------------------------------------------------------------------------
  Atom             x           y             z
-------------------------------------------------------------------------------
    1 Al    x       2.4472     -0.3703     -0.0000
            y       0.3703      2.4472     -0.0000
            z      -0.0000     -0.0000      2.7488
-------------------------------------------------------------------------------
    2 O     x      -1.7494      0.0000     -0.0000
            y       0.0000     -1.5135      0.2579
            z      -0.0000      0.3340     -1.8325
-------------------------------------------------------------------------------




  Elastic Constant Matrix: (Units=GPa)

-------------------------------------------------------------------------------
  Indices      1         2         3         4         5         6    
-------------------------------------------------------------------------------
       1    607.5122  322.9448  182.3240   44.5916    0.0000    0.0000
       2    322.9448  607.5122  182.3240  -44.5916    0.0000    0.0000
       3    182.3240  182.3240  606.3490    0.0000   -0.0000    0.0000
       4     44.5916  -44.5916    0.0000   95.6295    0.0000    0.0000
       5      0.0000    0.0000   -0.0000    0.0000   95.6295   44.5916
       6      0.0000    0.0000    0.0000    0.0000   44.5916  142.2837
-------------------------------------------------------------------------------


  Elastic Compliance Matrix: (Units=1/GPa)

-------------------------------------------------------------------------------
  Indices      1         2         3         4         5         6    
-------------------------------------------------------------------------------
       1    0.002667 -0.001449 -0.000366 -0.001919  0.000000 -0.000000
       2   -0.001449  0.002667 -0.000366  0.001919 -0.000000  0.000000
       3   -0.000366 -0.000366  0.001870 -0.000000  0.000000 -0.000000
       4   -0.001919  0.001919 -0.000000  0.012247 -0.000000  0.000000
       5    0.000000 -0.000000  0.000000 -0.000000  0.012247 -0.003838
       6   -0.000000  0.000000 -0.000000  0.000000 -0.003838  0.008231
-------------------------------------------------------------------------------

  Mechanical properties&#160;:

-------------------------------------------------------------------------------
  Convention&#160;:                    Reuss         Voigt         Hill
-------------------------------------------------------------------------------
  Bulk  Modulus (GPa)     =     352.01360     355.17322     353.59341
  Shear Modulus (GPa)     =     110.52804     142.29389     126.41097
-------------------------------------------------------------------------------
  Velocity S-wave (km/s)  =       5.33705       6.05561       5.70765
  Velocity P-wave (km/s)  =      11.34442      11.85012      11.60003
-------------------------------------------------------------------------------
  Compressibility (1/GPa) =    0.00284080
-------------------------------------------------------------------------------
  Stress axis&#160;:                     x             y             z
-------------------------------------------------------------------------------
  Youngs Moduli (GPa)     =     374.96404     374.96404     534.89590
-------------------------------------------------------------------------------
  Poissons Ratio (x)      =                     0.54318       0.19595
  Poissons Ratio (y)      =       0.54318                     0.19595
  Poissons Ratio (z)      =       0.13736       0.13736
-------------------------------------------------------------------------------


  Piezoelectric Strain Matrix: (Units=C/m**2)

-------------------------------------------------------------------------------
  Indices      1         2         3         4         5         6    
-------------------------------------------------------------------------------
       x    -0.00000  -0.00000  -0.00000  -0.00000  -0.00000  -0.00000
       y     0.00000  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
       z     0.00000   0.00000  -0.00000  -0.00000  -0.00000  -0.00000
-------------------------------------------------------------------------------


  Piezoelectric Stress Matrix: (Units=10**-11 C/N)

-------------------------------------------------------------------------------
  Indices      1         2         3         4         5         6    
-------------------------------------------------------------------------------
       x     0.00000  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
       y     0.00000  -0.00000  -0.00000   0.00000  -0.00000  -0.00000
       z     0.00000  -0.00000  -0.00000  -0.00000  -0.00000   0.00000
-------------------------------------------------------------------------------


  Static dielectric constant tensor&#160;: 

-------------------------------------------------------------------------------
              x         y         z
-------------------------------------------------------------------------------
       x    11.29306  -0.00000   0.00000
       y    -0.00000  11.29306  -0.00000
       z     0.00000  -0.00000  16.36466
--------------------------------------------------------------------------------

  High frequency dielectric constant tensor&#160;: 

-------------------------------------------------------------------------------
              x         y         z
-------------------------------------------------------------------------------
       x     5.63011  -0.00000   0.00000
       y    -0.00000   5.63011  -0.00000
       z     0.00000  -0.00000   6.08934
-------------------------------------------------------------------------------

  Static refractive indices&#160;: 

-------------------------------------------------------------------------------
    1 =    3.36052      2 =    3.36052      3 =    4.04533
-------------------------------------------------------------------------------

  High frequency refractive indices&#160;: 

-------------------------------------------------------------------------------
    1 =    2.37278      2 =    2.37278      3 =    2.46766
-------------------------------------------------------------------------------


  Time to end of optimisation =       0.0582 seconds


  Peak dynamic memory used =       1.86 MB 


  Timing analysis for GULP&#160;:

--------------------------------------------------------------------------------
  Task / Subroutine                                          Time (Seconds)
--------------------------------------------------------------------------------
  Calculation of reciprocal space energy and derivatives          0.0025
  Calculation of reciprocal space energy using symmetry           0.0016
  Calculation of real space energy and derivatives                0.0093
  Calculation of real space energy using symmetry                 0.0080
  Calculation and manipulation of Hessian matrix                  0.0006
  Calculation of matrix inversion                                 0.0006
  Symmetry generation of equivalent positions                     0.0003
  Global summation overhead                                       0.0198
--------------------------------------------------------------------------------
  Total CPU time                                                  0.0582
--------------------------------------------------------------------------------


  Marvin file written as example1.mvn
  XR file written as example1.xr


  Job Finished at 12:50.28  4th February   2021          


</pre>




</body></html>